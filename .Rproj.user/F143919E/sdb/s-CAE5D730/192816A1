{
    "contents" : "##################\n#Code that controls evolution\n#Author: Vincent Cannataro\n#WORK IN PROGRESS\n##################\n\n#The total population size of the individuals\nTotal.pop.size <- AA+Aa+aa\n\n#Matrix to keep track of genotypes over the generations\nevolution.matrix <- matrix(nrow=3,ncol=Generations, data=0)\nrownames(evolution.matrix) <- c(\"AA\",\"Aa\",\"aa\")\ncolnames(evolution.matrix) <- paste(\"Generation\",1:Generations)\nevolution.matrix[,1] <- c(AA,Aa,aa) #initialize the matrix\n\n\nOffspring.Genotype <- function(){\n  if(parent.1==1 & parent.2==1){\n    output <- 1\n  }\n  if(parent.1==3 & parent.2==3){\n    output <- 3\n  }\n  if(xor(parent.1==1 & parent.2==2 , parent.1==2 & parent.2==1)){\n    output <- sample(size=1,x=c(1,2),prob=c(0.5,0.5))\n  }\n  if(parent.1==2 & parent.2==2){\n    output <- sample(size=1,x=c(1,2,3),prob=c(0.25,0.5,0.25))\n  }\n  if(xor(parent.1==1 & parent.2==3 , parent.1==3 & parent.2==1)){\n    output <- 2\n  }\n  if(xor(parent.1==2 & parent.2==3 , parent.1==3 & parent.2==2)){\n    output <- sample(size=1,x=c(2,3),prob=c(0.5,0.5))\n  }\n  return(output)\n}\n\n\n\n\n\n##Loop that simulates evolution. Children choose their parents, allele combinations after that are random\nfor(i in 2:Generations){\n  for(j in 1:Total.pop.size){\n    \n    parent.1 <- sample(size=1,x=c(1,2,3),prob=c((evolution.matrix[1,i-1]/Total.pop.size),\n                                                (evolution.matrix[2,i-1]/Total.pop.size),\n                                                (evolution.matrix[3,i-1]/Total.pop.size)))\n    if(parent.1==1){\n      parent.2 <- sample(size=1,x=c(1,2,3),prob=c(((evolution.matrix[1,i-1]-1)/Total.pop.size),\n                                                  (evolution.matrix[2,i-1]/Total.pop.size),\n                                                  (evolution.matrix[3,i-1]/Total.pop.size)))\n    }\n    if(parent.1==2){\n      parent.2 <- sample(size=1,x=c(1,2,3),prob=c((evolution.matrix[1,i-1]/Total.pop.size),\n                                                  ((evolution.matrix[2,i-1]-1)/Total.pop.size),\n                                                  (evolution.matrix[3,i-1]/Total.pop.size)))\n    }\n    if(parent.1==3){\n      parent.2 <- sample(size=1,x=c(1,2,3),prob=c((evolution.matrix[1,i-1]/Total.pop.size),\n                                                  (evolution.matrix[2,i-1]/Total.pop.size),\n                                                  ((evolution.matrix[3,i-1]-1)/Total.pop.size)))\n    }\n    \n    offspring <- Offspring.Genotype()\n    evolution.matrix[offspring,i] <- evolution.matrix[offspring,i]+1\n    \n    \n  }\n  \n  \n  \n}\n\n\n\n\n\n",
    "created" : 1422584242675.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "626671068",
    "id" : "192816A1",
    "lastKnownWriteTime" : 1422589051,
    "path" : "~/GitHub/HW_dynamics/HW_dynamics_sim.R",
    "project_path" : "HW_dynamics_sim.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}